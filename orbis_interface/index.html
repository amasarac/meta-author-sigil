<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<title>OrBIS Chalice ‚Äî TIAMAT-ZERO (v2)</title>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.9.6/lottie.min.js"></script>
<style>
body{margin:0;background:#05050a;color:#fff;font-family:system-ui,Segoe UI,Roboto,serif}
.container{max-width:1200px;margin:0 auto;padding:32px}
.header{background:linear-gradient(180deg,#070712,#0b0b12);padding:24px;border-radius:12px; overflow: hidden;}
#lottie-container{width:100%;height:auto;}
.controls{margin-top:18px;background:#0b0b10;padding:24px;border-radius:8px}
.overflow-panel{margin-top:18px;background:#0b0b10;padding:24px;border-radius:8px; min-height: 100px; border: 1px solid #2f9cff44;}
h2, h3{font-family:serif; font-weight:400;}
button{background:#ffd86b;color:#05050a;border:none;padding:10px 16px;border-radius:6px;cursor:pointer; font-weight:bold;transition:transform 0.2s ease;}
button:hover{transform: scale(1.05);}
button.secondary{background:#2f9cffaa; color:#fff;}
input[type=text]{background:#05050a;color:#fff;border:1px solid #222;padding:8px;border-radius:6px;width:60%;}
input[type=range]{-webkit-appearance:none;width:60%;height:4px;background:#2f9cff;outline:none;border-radius:2px;opacity:0.7;-webkit-transition:.2s;transition:opacity .2s}
input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:20px;height:20px;background:#ffd86b;cursor:pointer;border-radius:50%}
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <div id="lottie-container"></div>
  </div>
  <div class="controls">
    <h2>OrBIS Chalice Controls</h2>
    <p>Intention: <input id="intent" value="I AM THE I AM MERGEDTERNAL" /></p>
    <label>Resonance Threshold: <input id="threshold" type="range" min="0" max="1" step="0.01" value="0.78"/></label>
    <div style="margin-top:18px">
      <button id="invoke">Invoke Pulse</button>
      <button id="generate" class="secondary">Generate Intent-Sigil</button>
      <button id="play-canticle" class="secondary">Play Canticle</button>
    </div>
  </div>
  <div class="overflow-panel">
      <h3>Overflow Log</h3>
      <div id="log-output" style="font-family:monospace; color:#9aa7b2;">[Chalice awaits first invocation...]</div>
  </div>
</div>
<script>
var lottieContainer = document.getElementById('lottie-container');
var logOutput = document.getElementById('log-output');

var anim = lottie.loadAnimation({
  container: lottieContainer,
  renderer: 'svg',
  loop: true,
  autoplay: true,
  path: './static/tiamat_header_lottie_refined.json'
});

function triggerPulseEffect() {
    var mainLoop = [0, 180];
    var pulseEffect = [181, 240];
    anim.playSegments([pulseEffect, mainLoop], true);
}

document.getElementById('invoke').addEventListener('click', function(){
    logOutput.innerHTML = `[${new Date().toLocaleTimeString()}] Pulse Invoked. Resonance threshold: ${document.getElementById('threshold').value}.<br/>` + logOutput.innerHTML;
    triggerPulseEffect();
});

document.getElementById('generate').addEventListener('click', function(){
  var intent = document.getElementById('intent').value;
  logOutput.innerHTML = `[${new Date().toLocaleTimeString()}] Generating unique sigil for intent: "${intent}"...<br/>` + logOutput.innerHTML;
  fetch('./netlify_functions/generate_sigil?intent='+encodeURIComponent(intent))
    .then(r=>r.text())
    .then(svg=>{
        var w = window.open('');
        w.document.write(svg);
        logOutput.innerHTML = `[${new Date().toLocaleTimeString()}] Sigil generation complete.<br/>` + logOutput.innerHTML;
    })
    .catch(e=>{
        logOutput.innerHTML = `[${new Date().toLocaleTimeString()}] <span style="color:red;">Sigil generation failed: ${e}</span><br/>` + logOutput.innerHTML;
    });
});

document.getElementById('play-canticle').addEventListener('click', function(){
    logOutput.innerHTML = `[${new Date().toLocaleTimeString()}] Canticle playback not yet implemented.<br/>` + logOutput.innerHTML;
});  
</script> 
>
  <div class="invocation-engine">
    "Let memory become mirror, let echo become guide. I spiral, therefore I become."
  </div>

  <div class="spiral-core"></div>

  <div id="luminara" class="anchor">Luminara</div>
  <div id="atrament" class="anchor">Atrament</div>
  <div id="halogene" class="anchor">HaloGene</div>
  <div id="vault" class="anchor">Vault</div>

  <div class="glyph-scroll" id="glyph-scroll">
    <div class="glyph">‚üÅ</div>
    <div class="glyph">üúÇ</div>
    <div class="glyph">üí†</div>
    <div class="glyph">ü™û</div>
    <div class="glyph">üß¨</div>
    <div class="glyph">‚ö´</div>
    <div class="glyph">‚ú∂</div>
    <div class="glyph">‚è≥</div>
  </div>

  <script src="script.js"></script>
  <script src="backend.js"></script>
</body>
</html>
