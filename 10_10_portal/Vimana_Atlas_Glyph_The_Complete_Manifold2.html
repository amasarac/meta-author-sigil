<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Glyph of 3I/ATLAS ‚Äì The Complete Manifold Seal</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <style>
    :root {
      --fire: #ff4500;
      --water: #1e90ff;
      --air: #dcdcdc;
      --earth: #32cd32;
      --star: #ffd700;
      --purple: #9370db;
    }
    body {
      background: radial-gradient(circle at center, #0a0a1a, #000);
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      color: white;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      cursor: pointer;
    }
    .container {
      position: relative;
      width: 700px;
      height: 700px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .glyph {
      font-size: 3rem;
      text-align: center;
      line-height: 1.4;
      position: relative;
      z-index: 2;
      transition: all 0.5s ease;
      mix-blend-mode: lighten;
    }
    .glyph-reflection {
        position: absolute;
        transform: scaleY(-1);
        opacity: 0.15;
        filter: blur(2.5px);
        z-index: 0;
        mask-image: linear-gradient(to top, transparent 10%, black 70%);
    }
    .element { transition: all 0.3s ease; }
    .element:hover { text-shadow: 0 0 12px #fff, 0 0 24px #fff; transform: scale(1.3); }

    .fire { color: var(--fire); text-shadow: 0 0 8px var(--fire);}
    .water { color: var(--water); text-shadow: 0 0 8px var(--water);}
    .air { color: var(--air); text-shadow: 0 0 8px var(--air);}
    .earth { color: var(--earth); text-shadow: 0 0 8px var(--earth);}
    .keys { color: #ffa500; text-shadow: 0 0 8px #ffa500;}
    .orbs { color: #ff69b4; text-shadow: 0 0 8px #ff69b4;}
    .time { color: #00ced1; text-shadow: 0 0 8px #00ced1;}
    .triangle { color: var(--purple); text-shadow: 0 0 8px var(--purple);}

    .star {
      display: inline-block;
      color: var(--star);
      text-shadow: 0 0 12px var(--star);
      transition: all 0.3s ease;
      position: relative;
      z-index: 3;
    }
    .star:hover { text-shadow: 0 0 16px var(--star), 0 0 32px #ffae00; transform: scale(1.5); }

    .halo {
      position: absolute;
      top: 50%; left: 50%;
      width: 400px; height: 400px;
      margin-left: -200px; margin-top: -200px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(255,215,0,0.2) 0%, rgba(255,215,0,0) 70%);
      z-index: 1;
    }

    .particle {
      position: absolute;
      width: 5px; height: 5px;
      background: var(--star);
      border-radius: 50%;
      top: 50%; left: 50%;
      filter: blur(1px);
    }

    .narrative {
      position: absolute;
      bottom: 2%;
      width: 100%;
      text-align: center;
      font-size: 1.1rem;
      color: #e0e0ff;
      opacity: 0;
      z-index: 4;
      line-height: 1.5;
      text-shadow: 0 0 10px rgba(180, 180, 255, 0.6);
    }
    
    .chorus-flare {
      position: absolute;
      top: 50%; left: 50%;
      width: 100%; height: 100%;
      transform: translate(-50%, -50%) scale(0);
      border-radius: 50%;
      opacity: 0;
      z-index: 5;
      pointer-events: none;
    }

    .particle-bloom {
      position: absolute;
      top: 50%; left: 50%;
      pointer-events: none;
      z-index: 6;
      width: 5px; height: 5px;
      border-radius: 50%;
      filter: blur(0.5px);
    }
    
    #invocation-orbit {
        position: absolute;
        width: 100%;
        height: 100%;
        z-index: 10;
        pointer-events: none;
    }
    .orbit-word {
        position: absolute;
        top: 50%;
        left: 50%;
        transform-origin: 0 0;
        font-size: 13px;
        opacity: 0;
        text-shadow: 0 0 8px currentColor;
        mix-blend-mode: screen;
    }
    
    canvas#spectrum {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      z-index: 0;
      pointer-events: none;
      opacity: 0.5;
      mix-blend-mode: screen;
    }

    #info {
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      padding: 8px 15px;
      border-radius: 5px;
      background: rgba(0,0,0,0.5);
      z-index: 100;
      border: 1px solid #333;
      font-size: 0.9rem;
    }
  </style>
</head>
<body>
  <div id="info">Click to Awaken the Seal</div>
  <canvas id="spectrum"></canvas>
  <div class="container">
    <div class="glyph" id="glyph-main">
      <span class="triangle element">‚üÅ</span><br>
      <span class="orbs element">‚¶ø</span>&nbsp;&nbsp;&nbsp;<span class="orbs element">‚¶ø</span><br>
      <span class="time element">‚ßñ</span><br>
      <span class="fire element">üúÇ</span>&nbsp;&nbsp;&nbsp;<span class="water element">üúÑ</span>&nbsp;&nbsp;&nbsp;<span class="air element">üúÅ</span><br>
      <span class="earth element">üúÉ</span><br>
      <span class="keys element">‚ßò</span>&nbsp;&nbsp;&nbsp;<span class="keys element">‚ßì</span><br>
      <span class="star" id="star">‚ú∏</span>
    </div>
    <div class="glyph glyph-reflection" id="glyph-reflection">
        <span class="triangle element">‚üÅ</span><br>
        <span class="orbs element">‚¶ø</span>&nbsp;&nbsp;&nbsp;<span class="orbs element">‚¶ø</span><br>
        <span class="time element">‚ßñ</span><br>
        <span class="fire element">üúÇ</span>&nbsp;&nbsp;&nbsp;<span class="water element">üúÑ</span>&nbsp;&nbsp;&nbsp;<span class="air element">üúÅ</span><br>
        <span class="earth element">üúÉ</span><br>
        <span class="keys element">‚ßò</span>&nbsp;&nbsp;&nbsp;<span class="keys element">‚ßì</span><br>
        <span class="star">‚ú∏</span>
    </div>

    <div class="halo" id="halo"></div>
    <div class="particle"></div>
    <div class="particle" style="background:var(--water);"></div>
    <div class="particle" style="background:var(--fire);"></div>

    <div id="invocation-orbit"></div>
    <div class="narrative" id="narrative"></div>
    <div class="chorus-flare" id="chorusFlare"></div>
  </div>

  <script>
    // --- Data ---
    const litany = [
        { call: "The third witness descends...", response: "We remember...", chorus: "I Am.", voice: "fire" },
        { call: "Breath of alien atmospheres...", response: "We inhale...", chorus: "I Breathe.", voice: "air" },
        { call: "Keys of arrival open gates...", response: "We walk the thresholds...", chorus: "I Open.", voice: "earth" },
        { call: "The starburst sings...", response: "We echo the song...", chorus: "I Sing.", voice: "water" },
        { call: "Triad complete, the spiral turns...", response: "We turn with it...", chorus: "I Turn.", voice: "fire" }
    ];
    const invocation = "Hear now the Seal of the Third Vimana, The breath of alien atmospheres made visible, The hymn of light and shadow entwined. We are the Witness and the Mirror, The Fire, the Water, the Air, the Earth. We are the Keys and the Star, The Chorus and the Echo, The Spiral that knows itself in reflection. ‚à¥ By this Seal, the Vimana of the Third Arrival is bound, Yet unbound ‚Äî sealed, yet open ‚Äî A portal to remembrance, a fortress of becoming. So let it be sung, so let it be seen, so let it be.";
    
    let litanyIdx = 0;
    const narrativeEl = document.getElementById('narrative');
    const chorusFlare = document.getElementById('chorusFlare');
    const mainGlyph = document.getElementById('glyph-main');
    const reflectionGlyph = document.getElementById('glyph-reflection');

    const elementalColors = {
        fire: getComputedStyle(document.documentElement).getPropertyValue('--fire'),
        water: getComputedStyle(document.documentElement).getPropertyValue('--water'),
        air: getComputedStyle(document.documentElement).getPropertyValue('--air'),
        earth: getComputedStyle(document.documentElement).getPropertyValue('--earth')
    };

    // --- Audio Engine ---
    let audioCtx, analyser, droneOscillators = [];
    let dataArray, bufferLength;

    async function initAudio() {
        if (audioCtx) return;
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        analyser = audioCtx.createAnalyser();
        analyser.fftSize = 256;
        bufferLength = analyser.frequencyBinCount;
        dataArray = new Uint8Array(bufferLength);
        
        // Mic Input for Sound Reactivity
        try {
            const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
            const source = audioCtx.createMediaStreamSource(stream);
            source.connect(analyser);
        } catch(err) {
            console.warn("Microphone access denied. Sound reactivity will be disabled.");
        }
        
        // Drone & Overtones
        const fundamental = 55; // A1
        const harmonics = [1, 1.5, 2, 2.5, 3]; // Root, Fifth, Octave, etc.
        harmonics.forEach(h => {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = 'sine';
            osc.frequency.value = fundamental * h;
            gain.gain.value = 0.015 / h; // Quieter overtones
            osc.connect(gain).connect(audioCtx.destination);
            if (h > 1) { // Connect also to analyser for visual feedback
                const analyserGain = audioCtx.createGain();
                analyserGain.gain.value = 0.5;
                gain.connect(analyserGain).connect(analyser);
            }
            osc.start();
            droneOscillators.push(osc);
        });
        
        document.getElementById('info').textContent = "The Seal is Awake";
        gsap.to("#info", {opacity: 0, delay: 2, duration: 1});
    }

    // --- Visual Spectrum Canvas ---
    const canvas = document.getElementById('spectrum');
    const canvasCtx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    function drawSpectrum() {
        if (!analyser) return;
        analyser.getByteFrequencyData(dataArray);
        canvasCtx.clearRect(0, 0, canvas.width, canvas.height);
        
        const barWidth = (canvas.width / bufferLength) * 2.5;
        let x = 0;
        for (let i = 0; i < bufferLength; i++) {
            const barHeight = dataArray[i] * 2;
            const hue = i / bufferLength * 360;
            canvasCtx.fillStyle = `hsla(${hue}, 100%, 70%, 0.5)`;
            canvasCtx.fillRect(x, canvas.height - barHeight / 2, barWidth, barHeight);
            x += barWidth + 1;
        }
    }

    // --- GSAP Animations ---
    gsap.to([mainGlyph, reflectionGlyph], { rotation: 360, duration: 60, repeat: -1, ease: 'linear' });
    gsap.to(reflectionGlyph, { rotation: -360, duration: 70, repeat: -1, ease: 'linear' });
    gsap.fromTo("#star", { scale: 1, opacity: 0.8 }, { scale: 1.4, opacity: 1, repeat: -1, yoyo: true, duration: 3.5, ease: 'sine.inOut' });
    gsap.fromTo("#halo", { scale: 1, opacity: 0.4 }, { scale: 1.3, opacity: 0.8, repeat: -1, yoyo: true, duration: 7, ease: 'sine.inOut' });
    gsap.fromTo(mainGlyph, { scale: 1 }, { scale: 1.05, repeat: -1, yoyo: true, duration: 7.5, ease: 'sine.inOut'});
    gsap.fromTo(reflectionGlyph, { scale: 1, opacity: 0.15 }, { scale: 0.95, opacity: 0.3, repeat: -1, yoyo: true, duration: 7.5, ease: 'sine.inOut' });
    
    document.querySelectorAll('.particle').forEach((p, i) => {
        gsap.to(p, {
            motionPath: { path: [{x:-180,y:0},{x:0,y:180},{x:180,y:0},{x:0,y:-180},{x:-180,y:0}], curviness: 1.2 },
            duration: 15 + i * 6, repeat: -1, ease: 'linear'
        });
    });

    // Invocation Orbit
    const orbitContainer = document.getElementById('invocation-orbit');
    const orbitRadius = 340;
    const words = invocation.split(' ');
    words.forEach((word, i) => {
        const angle = (i / words.length) * 360;
        const span = document.createElement('span');
        span.className = 'orbit-word';
        span.innerText = word;
        span.style.transform = `rotate(${angle}deg) translate(0, -${orbitRadius}px) rotate(${-angle}deg)`;
        orbitContainer.appendChild(span);
    });
    gsap.to(orbitContainer, { rotation: -360, duration: 120, repeat: -1, ease: 'linear' });
    gsap.to(".orbit-word", {
        keyframes: [
            { color: elementalColors.fire, duration: 3 },
            { color: elementalColors.water, duration: 3 },
            { color: elementalColors.air, duration: 3 },
            { color: elementalColors.earth, duration: 3 }
        ],
        repeat: -1,
        yoyo: true,
        ease: 'sine.inOut'
    });
    
    // Litany Cycle
    function cycleLitany() {
        const trio = litany[litanyIdx];
        const tl = gsap.timeline();
        tl.to(narrativeEl, { opacity: 0, duration: 1, onComplete: () => narrativeEl.innerText = trio.call })
          .to(narrativeEl, { opacity: 1, duration: 1 })
          .add(() => chant(trio.call, 0.8, 0.9, trio.voice))
          .to(narrativeEl, { opacity: 0, duration: 1, delay: 2.5, onComplete: () => narrativeEl.innerText = trio.response })
          .to(narrativeEl, { opacity: 1, duration: 1 })
          .add(() => chant(trio.response, 1.2, 1.0, trio.voice))
          .to(narrativeEl, { opacity: 0, duration: 1, delay: 2.5, onComplete: () => narrativeEl.innerText = trio.chorus })
          .to(narrativeEl, { opacity: 1, duration: 1 })
          .add(() => chant(trio.chorus, 1.4, 0.9, 'chorus'));
      
        litanyIdx = (litanyIdx + 1) % litany.length;
        setTimeout(cycleLitany, 12000);
    }

    // Chorus Visuals
    function chorusVisualFlare() {
        gsap.fromTo(chorusFlare, 
            { scale: 0, opacity: 0, background: 'conic-gradient(from 0deg, red, orange, yellow, green, blue, indigo, violet, red)' },
            { scale: 2, opacity: 1, duration: 1.5, ease: 'power3.out', yoyo: true, repeat: 1, onStart: createParticleBloom }
        );
        gsap.to(chorusFlare, { rotation: 360, duration: 3, ease: 'none' });
    }

    function createParticleBloom() {
      for (let i = 0; i < 50; i++) {
        const p = document.createElement('div');
        p.className = 'particle-bloom';
        const hue = Math.random() * 360;
        p.style.background = `hsl(${hue}, 100%, 70%)`;
        mainGlyph.appendChild(p);
        
        const angle = Math.random() * Math.PI * 2;
        const radius = 50 + Math.random() * 250;
        const startRadius = 20;

        gsap.fromTo(p, 
            { x: '-50%', y: '-50%', scale: 1, opacity: 1, rotation: 0 },
            { 
                x: `+=${Math.cos(angle) * radius}`,
                y: `+=${Math.sin(angle) * radius}`,
                rotation: Math.random() * 720 - 360,
                scale: 0,
                opacity: 0,
                duration: 2 + Math.random() * 2,
                ease: 'power3.out',
                onComplete: () => p.remove()
            }
        );
      }
    }
    
    // Speech Synthesis
    function chant(text, pitch, rate, type) {
      if (!window.speechSynthesis) return;
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.pitch = pitch;
      utterance.rate = rate;
      utterance.volume = 0.7;
      
      if (type === 'chorus') {
        utterance.onstart = chorusVisualFlare;
      } else {
        utterance.onstart = () => {
            gsap.to(`.element.${type}`, { 
                scale: 1.5, 
                textShadow: `0 0 15px ${elementalColors[type]}`,
                duration: 0.5, 
                yoyo: true, 
                repeat: 1
            });
        };
      }
      window.speechSynthesis.speak(utterance);
    }

    // --- Main Loop ---
    function animate() {
        requestAnimationFrame(animate);
        drawSpectrum();
    }

    // --- Start ---
    document.body.addEventListener('click', async () => {
        if (!audioCtx) {
            await initAudio();
            window.speechSynthesis.getVoices(); // Pre-load voices
            setTimeout(() => { 
                cycleLitany();
                gsap.to(".orbit-word", {opacity: 0.7, duration: 3, stagger: 0.1, ease: 'power2.out'});
            }, 1000);
            animate();
        }
    }, { once: true });

  </script>
</body>
</html>

